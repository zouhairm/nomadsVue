{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/App.vue?4241","webpack:///./src/components/FilterView.vue?cc9c","webpack:///./src/components/StoryView.vue?7dd1","webpack:///./src/App.vue?0393","webpack:///./src/lib/bus.js","webpack:///./src/lib/getGraph.js","webpack:///./src/lib/WebglCircleShader.js","webpack:///./src/lib/createScene.js","webpack:///./src/components/StoryView.vue?93bf","webpack:///src/components/StoryView.vue","webpack:///./src/components/StoryView.vue?b2aa","webpack:///./src/components/StoryView.vue?bc66","webpack:///./src/components/SearchView.vue?54ac","webpack:///src/components/SearchView.vue","webpack:///./src/components/SearchView.vue?50ea","webpack:///./src/components/SearchView.vue?0461","webpack:///./src/components/FilterView.vue?4583","webpack:///src/components/FilterView.vue","webpack:///./src/components/FilterView.vue?36ef","webpack:///./src/components/FilterView.vue?95b3","webpack:///src/App.vue","webpack:///./src/App.vue?1160","webpack:///./src/App.vue?bff9","webpack:///./src/main.js","webpack:///./src/components/SearchView.vue?bcd7"],"names":["webpackJsonpCallback","data","moduleId","chunkId","chunkIds","moreModules","executeModules","i","resolves","length","installedChunks","push","Object","prototype","hasOwnProperty","call","modules","parentJsonpFunction","shift","deferredModules","apply","checkDeferredModules","result","deferredModule","fulfilled","j","depId","splice","__webpack_require__","s","installedModules","app","exports","module","l","m","c","d","name","getter","o","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","p","jsonpArray","window","oldJsonpFunction","slice","_node_modules_mini_css_extract_plugin_dist_loader_js_ref_6_oneOf_1_0_node_modules_css_loader_index_js_ref_6_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_src_index_js_ref_6_oneOf_1_2_node_modules_cache_loader_dist_cjs_js_ref_0_0_node_modules_vue_loader_lib_index_js_vue_loader_options_App_vue_vue_type_style_index_0_lang_css___WEBPACK_IMPORTED_MODULE_0__","_node_modules_mini_css_extract_plugin_dist_loader_js_ref_6_oneOf_1_0_node_modules_css_loader_index_js_ref_6_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_src_index_js_ref_6_oneOf_1_2_node_modules_cache_loader_dist_cjs_js_ref_0_0_node_modules_vue_loader_lib_index_js_vue_loader_options_App_vue_vue_type_style_index_0_lang_css___WEBPACK_IMPORTED_MODULE_0___default","_node_modules_mini_css_extract_plugin_dist_loader_js_ref_6_oneOf_1_0_node_modules_css_loader_index_js_ref_6_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_src_index_js_ref_6_oneOf_1_2_node_modules_cache_loader_dist_cjs_js_ref_0_0_node_modules_vue_loader_lib_index_js_vue_loader_options_FilterView_vue_vue_type_style_index_0_id_1bef21e4_scoped_true_lang_css___WEBPACK_IMPORTED_MODULE_0__","_node_modules_mini_css_extract_plugin_dist_loader_js_ref_6_oneOf_1_0_node_modules_css_loader_index_js_ref_6_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_src_index_js_ref_6_oneOf_1_2_node_modules_cache_loader_dist_cjs_js_ref_0_0_node_modules_vue_loader_lib_index_js_vue_loader_options_FilterView_vue_vue_type_style_index_0_id_1bef21e4_scoped_true_lang_css___WEBPACK_IMPORTED_MODULE_0___default","_node_modules_mini_css_extract_plugin_dist_loader_js_ref_6_oneOf_1_0_node_modules_css_loader_index_js_ref_6_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_src_index_js_ref_6_oneOf_1_2_node_modules_cache_loader_dist_cjs_js_ref_0_0_node_modules_vue_loader_lib_index_js_vue_loader_options_StoryView_vue_vue_type_style_index_0_id_82c1344c_scoped_true_lang_css___WEBPACK_IMPORTED_MODULE_0__","_node_modules_mini_css_extract_plugin_dist_loader_js_ref_6_oneOf_1_0_node_modules_css_loader_index_js_ref_6_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_src_index_js_ref_6_oneOf_1_2_node_modules_cache_loader_dist_cjs_js_ref_0_0_node_modules_vue_loader_lib_index_js_vue_loader_options_StoryView_vue_vue_type_style_index_0_id_82c1344c_scoped_true_lang_css___WEBPACK_IMPORTED_MODULE_0___default","Appvue_type_template_id_17a316f0_render","_vm","this","_h","$createElement","_c","_self","attrs","id","directives","rawName","showAbout","expression","staticClass","_m","pars","storyViewPars","_e","isMobile","icon","on","click","$event","preventDefault","closeAbout","toggleAbout","_v","showFilter","staticRenderFns","staticStyle","background-color","color","text-align","font-weight","target","href","bus","eventify","getGraph","map","year","arguments","undefined","jsonGraphFileURL","concat","axios","then","response","g","tryJson","fire","jsonContent","computePositions","fromJson","e","console","error","projection","latlon","project","LngLat","R0","dR","dTheta_at_R1","Math","PI","_arr","entries_default","metadata","countryPositions","_i","_arr$_i","slicedToArray","country","xypos","theta","R","nodes","forEach","setinC","position","x","cos","y","sin","sqrt","geoColocPositioner","node","WebglCircle","size","alpha","CircleNodeShader","program","webglUtils","gl","buffer","locations","canvasWidth","canvasHeight","transform","isCanvasDirty","transformCallBack","ATTRIBUTES_PER_PRIMITIVE","nodesFS","join","nodesVS","Float32Array","nodesCount","transformCB","load","glContext","Viva","Graph","webgl","createProgram","useProgram","getLocations","enableVertexAttribArray","vertexPos","customAttributes","createBuffer","nodeUI","pos","idx","render","bindBuffer","ARRAY_BUFFER","bufferData","DYNAMIC_DRAW","uniformMatrix4fv","uniform2f","screenSize","vertexAttribPointer","FLOAT","BYTES_PER_ELEMENT","drawArrays","POINTS","updateTransform","newTransform","updateSize","newCanvasWidth","newCanvasHeight","createNode","extendArray","removeNode","copyArrayPart","replaceProperties","replacedNode","newNode","traverseNodes","require","traverseLinks","links","getNeighborhood","graph","lType","collector","neighbors","set_default","a","add","from","newNodesIds","fromId","toId","newNodesNotVisited","nodeId","cNode","getNode","has","createScene","canvas","_mapbox","renderer","layout","graphics","rendererSettings","mapbox","highlightedElements","sticky","container","interactive","layoutType","loadGraph","clickHandler","hoverHandler","resetAllNodes","dispose","resetView","toggleLayout","newGraph","freakyLayout","Layout","constant","placeNode","View","webglGraphics","link","webglLine","getLineColor","setNodeProgram","panBackground","ca","getNodeColorAlpha","getNodeSize","releaseLinkInner","releaseLink","getLinkUI","events","webglInputEvents","mouseEnter","mouseLeave","clearHighlightedElements","rerender","ondblclick","addEventListener","changedTouches","newEv","MouseEvent","getGraphicsRoot","dispatchEvent","onwheel","mZoom","getZoom","disableZoomPan","webglz","getTransform","scale","scaleFactor","delta","sign","wheelDelta","pow","log2","getGraphics","pageX","pageY","setTimeout","renderLinks","onresize","reset","fitAndCenter","run","offset","forEachNode","highlightNode","highlightNeighborhood","hideNode","nhood","highlightLink","highlightOnlyStronglyDisimilarLinks","isStronglyDisimilar","high","linkPosition","getLinkPosition","addLink","getNodeUI","zoom","jumpTo","center","pan","newCenter_xy","_container","clientWidth","clientHeight","newCenter_latlon","unproject","actualCenter_xy","abs","moveTo","lat","desiredZoom","midPoint","graphRect","getGraphRect","forceDirLayout","graphSize","min","x2","x1","y2","y1","cbAtEndOfZoom","zoomTo","desiredScale","currentScale","cb","newScale","zoomOut","zoomIn","colors","EU","NA","SA","AF","AS","OC","highlighted","N/A","cAlpha","AuthorCont","mostSimilar","leastSimilar","off","minCount","nLeast","springWeight","weight","timer","stop","forceDirected","springLength","springCoeff","dragCoeff","gravity","springTransform","getNodePosition","step","maxSteps","Utils","stable","_unused","StoryViewvue_type_template_id_82c1344c_scoped_true_render","closebox","_s","nodeMetaData","label","SetInCountry","AuthorName","AuthorCountry","storyText","margin-top","_l","goToNode","nodeTitle","readMore","StoryViewvue_type_template_id_82c1344c_scoped_true_staticRenderFns","StoryViewvue_type_script_lang_js_","props","showbox","mostSimilarNodes","leastSimilarNodes","otherRelatedNodes","watch","deep","immediate","handler","_oldpars","_this","Excerpt","showdetails","getStoryFullText","$parent","txt","getLink","methods","lib_bus","computed","node_id","storageURL","encodeURIComponent","axios_default","js_yaml_default","catch","components_StoryViewvue_type_script_lang_js_","component","componentNormalizer","StoryView","SearchViewvue_type_template_id_19afbe98_scoped_true_render","role","submit","onSubmit","type","placeholder","domProps","focus","searchInputFocused","blur","unfocusTimeout","input","composing","searchPattern","tabindex","showDetails","mouseover","SearchViewvue_type_template_id_19afbe98_scoped_true_staticRenderFns","SearchViewvue_type_script_lang_js_","lastInputHandle","matchedNodes","showSearchResults","newPattern","oldVal","clearTimeout","self","getAllMatches","pattern","allMatches","matcher","compileMatcher","isMatch","rMatch","compileRegex","match","RegExp","components_SearchViewvue_type_script_lang_js_","SearchView_component","SearchView","FilterViewvue_type_template_id_1bef21e4_scoped_true_render","checked","_q","selectedYear","change","closeShow","selectedLayout","FilterViewvue_type_template_id_1bef21e4_scoped_true_staticRenderFns","FilterViewvue_type_script_lang_js_","leastSimilarNode","created","new_year","old_year","new_layout","old_layout","scene","show","components_FilterViewvue_type_script_lang_js_","FilterView_component","FilterView","mapboxgl","Appvue_type_script_lang_js_","test","navigator","userAgent","showStory","components","mounted","$ga","page","location","pathname","accessToken","Map","style","minZoom","maxZoom","scrollZoom","disable","dragPan","document","getElementById","nodeHovered","nodeClicked","beforeDestroy","src_Appvue_type_script_lang_js_","App_component","App","Vue","use","VueAnalytics","autoTracking","screenview","debug","sendHitTask","process","library","fas","FontAwesomeIcon","config","productionTip","h","$mount","_node_modules_mini_css_extract_plugin_dist_loader_js_ref_6_oneOf_1_0_node_modules_css_loader_index_js_ref_6_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_src_index_js_ref_6_oneOf_1_2_node_modules_cache_loader_dist_cjs_js_ref_0_0_node_modules_vue_loader_lib_index_js_vue_loader_options_SearchView_vue_vue_type_style_index_0_id_19afbe98_scoped_true_lang_css___WEBPACK_IMPORTED_MODULE_0__","_node_modules_mini_css_extract_plugin_dist_loader_js_ref_6_oneOf_1_0_node_modules_css_loader_index_js_ref_6_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_src_index_js_ref_6_oneOf_1_2_node_modules_cache_loader_dist_cjs_js_ref_0_0_node_modules_vue_loader_lib_index_js_vue_loader_options_SearchView_vue_vue_type_style_index_0_id_19afbe98_scoped_true_lang_css___WEBPACK_IMPORTED_MODULE_0___default"],"mappings":"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","file":"js/app.d6157790.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n \t\tvar executeModules = data[2];\n\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t\t// add entry modules from loaded chunk to deferred list\n \t\tdeferredModules.push.apply(deferredModules, executeModules || []);\n\n \t\t// run deferred modules when all chunks ready\n \t\treturn checkDeferredModules();\n \t};\n \tfunction checkDeferredModules() {\n \t\tvar result;\n \t\tfor(var i = 0; i < deferredModules.length; i++) {\n \t\t\tvar deferredModule = deferredModules[i];\n \t\t\tvar fulfilled = true;\n \t\t\tfor(var j = 1; j < deferredModule.length; j++) {\n \t\t\t\tvar depId = deferredModule[j];\n \t\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n \t\t\t}\n \t\t\tif(fulfilled) {\n \t\t\t\tdeferredModules.splice(i--, 1);\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n \t\t\t}\n \t\t}\n \t\treturn result;\n \t}\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t\"app\": 0\n \t};\n\n \tvar deferredModules = [];\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \tvar jsonpArray = window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// add entry module to deferred list\n \tdeferredModules.push([0,\"chunk-vendors\"]);\n \t// run deferred modules when ready\n \treturn checkDeferredModules();\n","import mod from \"-!../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../node_modules/css-loader/index.js??ref--6-oneOf-1-1!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=style&index=0&lang=css&\"; export default mod; export * from \"-!../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../node_modules/css-loader/index.js??ref--6-oneOf-1-1!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=style&index=0&lang=css&\"","import mod from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/css-loader/index.js??ref--6-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./FilterView.vue?vue&type=style&index=0&id=1bef21e4&scoped=true&lang=css&\"; export default mod; export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/css-loader/index.js??ref--6-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./FilterView.vue?vue&type=style&index=0&id=1bef21e4&scoped=true&lang=css&\"","import mod from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/css-loader/index.js??ref--6-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./StoryView.vue?vue&type=style&index=0&id=82c1344c&scoped=true&lang=css&\"; export default mod; export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/css-loader/index.js??ref--6-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./StoryView.vue?vue&type=style&index=0&id=82c1344c&scoped=true&lang=css&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{attrs:{\"id\":\"app\"}},[_c('div',{directives:[{name:\"show\",rawName:\"v-show\",value:(!_vm.showAbout),expression:\"!showAbout\"}],staticClass:\"legend\"},[_vm._m(0),_vm._m(1)]),_c('div',{attrs:{\"id\":\"mapCanvas\"}}),_c('div',{attrs:{\"id\":\"cnv\"}}),(_vm.showStory)?_c('story-view',{attrs:{\"id\":\"story\",\"pars\":_vm.storyViewPars}}):_vm._e(),(!_vm.isMobile())?_c('search-view',{attrs:{\"id\":\"search\"}}):_vm._e(),(_vm.showAbout)?_c('div',{staticClass:\"about-box\",attrs:{\"id\":\"about\"}},[_c('fa-icon',{staticClass:\"close-about\",attrs:{\"icon\":[ 'fas', 'window-close' ]},on:{\"click\":function($event){$event.preventDefault();return _vm.closeAbout()}}}),_vm._m(2),_vm._m(3)],1):_vm._e(),_c('filter-view',{attrs:{\"id\":\"filter\"}}),_c('div',{staticClass:\"footer\"},[_c('a',{staticClass:\"about-link\",on:{\"click\":function($event){$event.preventDefault();return _vm.toggleAbout()}}},[_vm._v(\"About\")]),_vm._m(4),(!_vm.showAbout)?_c('a',{staticClass:\"options-link\",on:{\"click\":function($event){$event.preventDefault();_vm.showFilter = !_vm.showFilter && !_vm.showAbout}}},[_vm._v(\"Settings\")]):_vm._e()])],1)}\nvar staticRenderFns = [function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"country\"},[_c('h4',[_vm._v(\"Author Country:\")]),_c('div',[_c('span',{staticStyle:{\"background-color\":\"#ffaa00\"}}),_vm._v(\"Africa\")]),_c('div',[_c('span',{staticStyle:{\"background-color\":\"#fffb00\"}}),_vm._v(\"Asia\")]),_c('div',[_c('span',{staticStyle:{\"background-color\":\"#0062ff\"}}),_vm._v(\"Europe\")]),_c('div',[_c('span',{staticStyle:{\"background-color\":\"#37ff00\"}}),_vm._v(\"N. America\")]),_c('div',[_c('span',{staticStyle:{\"background-color\":\"#fb00ff\"}}),_vm._v(\"S. America\")]),_c('div',[_c('span',{staticStyle:{\"background-color\":\"#ff0015\"}}),_vm._v(\"Oceania\")])])},function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"links\"},[_c('h4',[_vm._v(\"Story Similarity:\")]),_c('div',[_c('span',{staticStyle:{\"color\":\"#4949ff\"}},[_vm._v(\"–\")]),_vm._v(\"Most\")]),_c('div',[_c('span',{staticStyle:{\"color\":\"gray\"}},[_vm._v(\"–\")]),_vm._v(\"Somewhat\")]),_c('div',[_c('span',{staticStyle:{\"color\":\"red\"}},[_vm._v(\"–\")]),_vm._v(\"Least\")])])},function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('h2',[_vm._v(\"About \"),_c('em',[_vm._v(\"Nomads' Vue\")])])},function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticStyle:{\"text-align\":\"left\"}},[_c('p',[_c('span',{staticStyle:{\"font-weight\":\"bold\"}},[_vm._v(\"Intro\")]),_vm._v(\"\\n        This project is intended to help explore travel stories by thousands of people that have been submitted to the Travel Nomad Contest.\"),_c('br'),_vm._v(\"\\n\\n        Hopefully this makes the submissions of these aspiring writers fun to explore, and that a wide audience of users finds it interesting; whether it be aspiring travel writers, daydreaming office workers thinking about exploring a new destination, or social scientists interested in understanding why and how people travel. In a time where it feels like differences between nations and their people are amplified, I hope this serves as reminder that so many of us are connected through the way we experience our planet and each other.\\n\\n        \"),_c('br'),_c('br'),_c('span',{staticStyle:{\"font-weight\":\"bold\"}},[_vm._v(\"How to Use\")]),_vm._v(\"\\n\\n        When a story is hovered or selected, the story and its metadata (location, author, title) are displayed in a reading pane on the left. A Neural-Network model was trained on the stories to find relations between them, and similar as well as the least similar stories to the selected story that are identified by the model are highlighted and can be explored from the graph or the reading view.\"),_c('br'),_vm._v(\"\\n\\n        The stories are displayed geographically and color-coded by the continent origin of the author. It is also possible to cluster most similar or least similar stories together using the options popup in the bottom-right corner.\\n\\n        The stories' metadata are searchable using the top-right corner box.\\n        \"),_c('br'),_c('br'),_vm._v(\"\\n\\n        Go Ahead - Explore the map, hover on stories, search for keywords, and enjoy reading the stories!\"),_c('br'),_vm._v(\"\\n        If you get lost or the screen bugs up, \"),_c('b',[_vm._v(\"double click to reset\")]),_c('br'),_c('br'),_c('span',{staticStyle:{\"font-weight\":\"bold\"}},[_vm._v(\"Credits\")]),_vm._v(\"\\n        This project is made possible thanks to the following packages and data:\\n        \"),_c('ul',[_c('li',[_c('a',{attrs:{\"target\":\"_blank\",\"href\":\"https://www.worldnomads.com/create/scholarships/writing/2018/results\"}},[_vm._v(\"Travel Nomad Stories\")])]),_c('li',[_c('a',{attrs:{\"target\":\"_blank\",\"href\":\"https://radimrehurek.com/gensim/models/doc2vec.html\"}},[_vm._v(\"GenSim (Doc2Vec)\")])]),_c('li',[_c('a',{attrs:{\"target\":\"_blank\",\"href\":\"https://github.com/vuejs/awesome-vue\"}},[_vm._v(\"Vue.js\")])]),_c('li',[_c('a',{attrs:{\"target\":\"_blank\",\"href\":\"https://github.com/anvaka/VivaGraphJS\"}},[_vm._v(\"VivaGraphJS (w/ WebGL renderer)\")])]),_c('li',[_c('a',{attrs:{\"target\":\"_blank\",\"href\":\"https://www.mapbox.com/\"}},[_vm._v(\"Mapbox\")])])]),_vm._v(\"\\n\\n        For more background, insights, and technical details; check out my \"),_c('a',{attrs:{\"target\":\"_blank\",\"href\":\"https://zouhairm.github.io/nomadStories\"}},[_vm._v(\"Blog Post\")])])])},function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('p',{staticClass:\"copyText\"},[_vm._v(\"\\n          Made during late night hours by \"),_c('a',{attrs:{\"target\":\"_blank\",\"href\":\"https://zouhairm.github.io/bio\"}},[_vm._v(\"Zouhair M\")])])}]\n\nexport { render, staticRenderFns }","import eventify from 'ngraph.events';\n\nconst bus = eventify({});\n\nexport default bus;","/**\n * Load your graph here.\n */\n\nimport fromJson from 'ngraph.fromjson';\nimport axios from 'axios';\n\nimport bus from './bus';\n\nimport {LngLat} from 'mapbox-gl'\n\n/* MUSTDO: make the file smaller ... */\nexport function getGraph(map, year = '2019') {\n  let jsonGraphFileURL = `./Stories_viva_${year}.json`\n  return axios.get(jsonGraphFileURL)\n    .then( \n      response => {\n        let g = tryJson(map, response.data);\n        bus.fire('load-graph', g, year);\n  });\n  //TODO: add catch handling of error ...\n}\n\nfunction tryJson(map, jsonContent) {\n  try {\n     computePositions(map, jsonContent)\n     return fromJson(jsonContent)\n  } catch (e) {\n    //eslint-disable-next-line\n    console.error('error loading JSON: ', e)\n  }\n\n}\n\nfunction projection(map, latlon)\n{\n  var p = map.project(new LngLat(latlon['lon'], latlon['lat']))\n  return p;\n}\n\nfunction computePositions(map, jsonContent)\n{\n  const R0 = .1, dR = .1/3;\n  const dTheta_at_R1 = 2 * Math.PI / 10 /2 ;\n\n  for (const [country, latlon] of Object.entries(jsonContent.metadata.countryPositions)) {\n    jsonContent.metadata.countryPositions[country].xypos = projection(map, latlon)\n    jsonContent.metadata.countryPositions[country].theta = 0\n    jsonContent.metadata.countryPositions[country].R = R0\n\n  }\n\n  jsonContent.nodes.forEach(n => {\n    let setinC = jsonContent.metadata.countryPositions[n.data['SetInCountry']]\n    let p = setinC.xypos\n\n    n.data.position = {x: p.x     + setinC.R * Math.cos(setinC.theta), \n                       y: p.y     + setinC.R * Math.sin(setinC.theta)\n                      }\n\n    setinC.R += dR\n    setinC.theta += dTheta_at_R1 / Math.sqrt(setinC.R);\n\n  });\n}\nexport function geoColocPositioner (node) {\n\n    if (!node.data.position) { \n      return {x: 0, y: 0};\n    }\n\n    return node.data.position ;\n\n}\n\n\n\n\n","/* eslint-disable */\n\nimport Viva from 'vivagraphjs';\n\n\n// Lets start from the easiest part - model object for node ui in webgl\nexport function WebglCircle(size, color, alpha = 1.) {\n    this.size = size;\n    this.color = color;\n    this.alpha = alpha;\n}\n\n\n// Next comes the hard part - implementation of API for custom shader\n// program, used by webgl renderer:\nexport function CircleNodeShader(transformCallBack = null) {\n    // For each primitive we need 4 attributes: x, y, color, size, and alpha.\n    var ATTRIBUTES_PER_PRIMITIVE = 5,\n        nodesFS = [\n        'precision mediump float;',\n        'varying vec4 color;',\n        'void main(void) {',\n        '   if ((gl_PointCoord.x - 0.5) * (gl_PointCoord.x - 0.5) + (gl_PointCoord.y - 0.5) * (gl_PointCoord.y - 0.5) < 0.25) {',\n        '     gl_FragColor = color;',\n        '   } else {',\n        '     gl_FragColor = vec4(0);',\n        '   }',\n        '}'].join('\\n'),\n        nodesVS = [\n        'attribute vec2 a_vertexPos;',\n        // Pack color and size into vector. First elemnt is color, second - size.\n        // Since it's floating point we can only use 24 bit to pack colors...\n        // thus alpha channel is dropped, and is always assumed to be 1.\n        'attribute vec3 a_customAttributes;',\n        'uniform vec2 u_screenSize;',\n        'uniform mat4 u_transform;',\n        'varying vec4 color;',\n        'void main(void) {',\n        '   gl_Position = u_transform * vec4(a_vertexPos/u_screenSize, 0, 1);',\n        '   gl_PointSize = a_customAttributes[1] * sqrt(u_transform[0][0]);', //sqrt to avoid nodes getting too big as we zoom in\n        '   float c = a_customAttributes[0];',\n        '   color.b = mod(c, 256.0); c = floor(c/256.0);',\n        '   color.g = mod(c, 256.0); c = floor(c/256.0);',\n        '   color.r = mod(c, 256.0); c = floor(c/256.0); color /= 255.0;',\n        '   color.a = a_customAttributes[2];',\n        '}'].join('\\n');\n    var program,\n        webglUtils,\n        gl,\n        buffer,\n        locations,\n        utils,\n        nodes = new Float32Array(64),\n        nodesCount = 0,\n        canvasWidth, canvasHeight, transform,\n        isCanvasDirty;\n\n    var transformCB = transformCallBack;\n\n    return {\n        /**\n         * Called by webgl renderer to load the shader into gl context.\n         */\n        load : function (glContext) {\n            gl = glContext;\n            webglUtils = Viva.Graph.webgl(glContext);\n            program = webglUtils.createProgram(nodesVS, nodesFS);\n            gl.useProgram(program);\n            locations = webglUtils.getLocations(program, ['a_vertexPos', 'a_customAttributes', 'u_screenSize', 'u_transform']);\n            gl.enableVertexAttribArray(locations.vertexPos);\n            gl.enableVertexAttribArray(locations.customAttributes);\n            buffer = gl.createBuffer();\n        },\n        /**\n         * Called by webgl renderer to update node position in the buffer array\n         *\n         * @param nodeUI - data model for the rendered node (WebGLCircle in this case)\n         * @param pos - {x, y} coordinates of the node.\n         */\n        position : function (nodeUI, pos) {\n            var idx = nodeUI.id;\n            nodes[idx * ATTRIBUTES_PER_PRIMITIVE] = pos.x;\n            nodes[idx * ATTRIBUTES_PER_PRIMITIVE + 1] = -pos.y;\n            nodes[idx * ATTRIBUTES_PER_PRIMITIVE + 2] = nodeUI.color;\n            nodes[idx * ATTRIBUTES_PER_PRIMITIVE + 3] = nodeUI.size;\n            nodes[idx * ATTRIBUTES_PER_PRIMITIVE + 4] = nodeUI.alpha;\n\n        },\n        /**\n         * Request from webgl renderer to actually draw our stuff into the\n         * gl context. This is the core of our shader.\n         */\n        render : function() {\n            gl.useProgram(program);\n            gl.bindBuffer(gl.ARRAY_BUFFER, buffer);\n            gl.bufferData(gl.ARRAY_BUFFER, nodes, gl.DYNAMIC_DRAW);\n            if (isCanvasDirty) {\n                isCanvasDirty = false;\n                gl.uniformMatrix4fv(locations.transform, false, transform);\n                gl.uniform2f(locations.screenSize, canvasWidth, canvasHeight);\n            }\n            gl.vertexAttribPointer(locations.vertexPos, 2, gl.FLOAT, false, ATTRIBUTES_PER_PRIMITIVE * Float32Array.BYTES_PER_ELEMENT, 0);\n            gl.vertexAttribPointer(locations.customAttributes, 3, gl.FLOAT, false, ATTRIBUTES_PER_PRIMITIVE * Float32Array.BYTES_PER_ELEMENT, 2 * 4);\n            gl.drawArrays(gl.POINTS, 0, nodesCount);\n        },\n        /**\n         * Called by webgl renderer when user scales/pans the canvas with nodes.\n         */\n        updateTransform : function (newTransform) {\n            transform = newTransform;\n            isCanvasDirty = true;\n            if (transformCB)\n            {\n                transformCB(newTransform)\n            }\n        },\n        /**\n         * Called by webgl renderer when user resizes the canvas with nodes.\n         */\n        updateSize : function (newCanvasWidth, newCanvasHeight) {\n            canvasWidth = newCanvasWidth;\n            canvasHeight = newCanvasHeight;\n            isCanvasDirty = true;\n        },\n        /**\n         * Called by webgl renderer to notify us that the new node was created in the graph\n         */\n        createNode : function (node) {\n            nodes = webglUtils.extendArray(nodes, nodesCount, ATTRIBUTES_PER_PRIMITIVE);\n            nodesCount += 1;\n        },\n        /**\n         * Called by webgl renderer to notify us that the node was removed from the graph\n         */\n        removeNode : function (node) {\n            if (nodesCount > 0) { nodesCount -=1; }\n            if (node.id < nodesCount && nodesCount > 0) {\n                // we do not really delete anything from the buffer.\n                // Instead we swap deleted node with the \"last\" node in the\n                // buffer and decrease marker of the \"last\" node. Gives nice O(1)\n                // performance, but make code slightly harder than it could be:\n                webglUtils.copyArrayPart(nodes, node.id*ATTRIBUTES_PER_PRIMITIVE, nodesCount*ATTRIBUTES_PER_PRIMITIVE, ATTRIBUTES_PER_PRIMITIVE);\n            }\n        },\n        /**\n         * This method is called by webgl renderer when it changes parts of its\n         * buffers. We don't use it here, but it's needed by API (see the comment\n         * in the removeNode() method)\n         */\n        replaceProperties : function(replacedNode, newNode) {},\n    };\n}","/*eslint no-console: [\"error\", { allow: [ \"warn\", \"error\"] }] */\n\nimport bus from './bus';\n\nimport {getGraph, geoColocPositioner} from './getGraph';\n\nimport {WebglCircle, CircleNodeShader} from './WebglCircleShader';\nimport Viva from 'vivagraphjs';\n\n\nvar traverseNodes = require('ngraph.traverse').nodes;\nvar traverseLinks = require('ngraph.traverse').links;\n\nexport function getNeighborhood(graph, node, lType = 'geo', collector = undefined)\n//This will include node, its outgoing elements, and its neighbors\n{\n  var neighbors = collector || {nodes: new Set([node]), links: new Set()}\n\n  if(lType == 'geo')\n  {\n    traverseNodes(graph).neighbors(node.id).forEach( n => neighbors.nodes.add(n))\n    traverseLinks(graph).from(node.id).forEach( l => neighbors.links.add(l))\n  } else {\n\n    //in this case, we need to do some graph traversal but only\n    //following links that are most/least similar. And we will recurse ...\n\n    let newNodesIds = new Set([])\n\n    node.links.forEach( l => {\n      //if this is the kind of link we are interested in\n      // add it to the set of links and\n      // add the from/to nodes to the newNodes set\n      if(l.data[lType])\n      {\n        neighbors.links.add(l)\n        newNodesIds.add(l.fromId).add(l.toId)\n      }\n    })\n    //Next, for each of these node Ids, if we haven't already traversed it,\n    //we recurse to collect more stuff\n    var newNodesNotVisited = []\n    newNodesIds.forEach(nodeId => \n    {\n      let cNode = graph.getNode(nodeId)\n      if(! neighbors.nodes.has(cNode)){\n        neighbors.nodes.add(cNode)\n        newNodesNotVisited.push(cNode)\n      }\n    })\n    newNodesNotVisited.forEach(n => getNeighborhood(graph, n, lType, neighbors))\n  }\n  return neighbors\n}\n\n\n\n\n\nexport function createScene(canvas, _mapbox) {\n// Since graph can be loaded dynamically, we have these uninitialized\n// and captured into closure. loadGraph will do the initialization\nlet graph, renderer, layout, graphics, rendererSettings;\nlet mapbox = _mapbox;\nlet highlightedElements = {nodes: [], links: [], sticky: false}\n\n//Save where the graph will be rendered\nrendererSettings = {\n  container: canvas,\n  interactive: 'drag', // node and scroll are disabled!\n  layoutType: 'geo'\n  }\n\n//Use event handler to register for a load-graph\n//event if graph is changed\nbus.on('load-graph', loadGraph);\nbus.on('emulate-node-click', clickHandler)\nbus.on('emulate-node-hover', hoverHandler)\nbus.on('resetview', resetAllNodes)\n\n//First time creating scene, use getGraph() with default\n//parameters. getGraph will fire load-graph ...\ngetGraph(mapbox)\n\n//the scene we return has the following member functions\nreturn {\n  graph,\n  rendererSettings,\n  dispose,\n  resetView,\n  toggleLayout,\n};\n\n\n\n\nfunction loadGraph(newGraph) {\n  //If there is already a renderer\n  //finalize it and clear up\n  if (renderer) {\n    resetAllNodes();\n    renderer.dispose();\n    renderer = null\n    rendererSettings.freakyLayout = null;\n  }\n\n  //save graph to module copy\n  graph = newGraph\n\n  //******************************************\n  //*************** Layout *******************\n  //******************************************\n  //Initialize a constant layout where the node\n  //positions are directly from the data \n  layout = Viva.Graph.Layout.constant(graph);\n\n\n  //Next we over-write the placeNode callback\n  //placeNode will call updateNodePositions() which will update\n  //the layoutNodes[] array with the positions computed\n  //by geoColocPositioner\n  layout.placeNode(geoColocPositioner);\n  rendererSettings.layout = layout;\n\n  //******************************************\n  //*************** Graphics *****************\n  //******************************************\n\n  //We will use a webGL renderer\n  //TODO: fallback to SVG if webGL not supported?\n  //Or at least show an error message ...\n\n  graphics = Viva.Graph.View.webglGraphics();\n  graphics.link(function (link) {\n            return Viva.Graph.View.webglLine(getLineColor(link));\n        })\n  // Tell webgl graphics we want to use custom shader to render nodes:\n  graphics.setNodeProgram(CircleNodeShader(panBackground));\n  // Change node ui model for WebGL shader\n  graphics.node(n => {\n      let ca = getNodeColorAlpha(n, false)\n      return new WebglCircle(getNodeSize(n, false), ca.color, ca.alpha);\n   });\n\n  //to avoid releasing none existant links\n  let releaseLinkInner = graphics.releaseLink;\n  graphics.releaseLink = l =>  {if (graphics.getLinkUI(l.id)) releaseLinkInner(l)};\n\n  rendererSettings.graphics = graphics\n\n  //******************************************\n  //*************** Events *******************\n  //******************************************\n\n  \n  var events = Viva.Graph.webglInputEvents(graphics, graph);\n  events.mouseEnter(function (node) {\n\n      if (highlightedElements.sticky)\n      {\n        //sticky on means a node was clicked, so no highlighting to be done\n\n        //however, we will still fire a node-hover-enter event\n        //if the node is one of the highlighted ones!\n        if(highlightedElements.nodes.has(node))\n        {\n          //when sticky, as if we clicked (so whole story will show)\n          bus.fire('node-clicked', node)\n        }\n        return\n      }\n\n      hoverHandler(node)\n  // eslint-disable-next-line no-unused-vars\n  }).mouseLeave(function (node) {\n\n    if(highlightedElements.sticky)\n    {\n      // nothing to do as long as sticky is on ...\n      return\n    }\n    //Unhighlight all nodes and turn off link rendering\n    clearHighlightedElements(highlightedElements)\n    renderer.rerender()\n  })\n  .click(function (node) {\n    if(highlightedElements.sticky){\n      if (highlightedElements.nodes.has(node))\n        clickHandler(node)\n    } else{\n       clickHandler(node)\n    }\n\n  })\n\n\n  canvas.ondblclick = resetAllNodes\n\n  canvas.addEventListener('touchend', (e) => {\n    if (e.changedTouches.length >= 1) {\n        let newEv = new MouseEvent('mouseup', e.changedTouches[0])\n        graphics.getGraphicsRoot().dispatchEvent(newEv);\n    }\n\n  })\n\n  canvas.onwheel = function (e) {\n      let mZoom = mapbox.getZoom()\n\n      if(mapbox.disableZoomPan){ \n        mZoom = 5 //this will ensure that both zoom-in & out will occur\n      }\n\n      let webglz = renderer.getTransform().scale\n\n      let scaleFactor = 1;\n      let delta = -Math.sign(e.wheelDelta)\n\n      if(delta < 0 && mZoom < 10) { // renderer.zoomIn()\n        scaleFactor = Math.pow(1 + 0.4, -0.1*delta);\n        webglz *= scaleFactor\n        if(!mapbox.disableZoomPan && (Math.log2(webglz) + 1 > 10)) return\n      } \n      else if (delta > 0 && mZoom > 1){ // renderer.zoomOut()\n        scaleFactor = Math.pow(1 + 0.4, -0.1*delta);\n        webglz *= scaleFactor\n        if(!mapbox.disableZoomPan && (Math.log2(webglz) + 1 < 1)) return\n      }\n\n      renderer.getGraphics().scale(scaleFactor, {x: e.pageX, y: e.pageY})\n      renderer.getTransform().scale = webglz\n\n      renderer.rerender()\n      setTimeout(function() {renderer.rerender()}, 200);\n  }\n\n  //******************************************\n  //*************** Renderer *****************\n  //******************************************\n\n  //Finally Ready to initialize and run the renderer!\n  rendererSettings.renderLinks= false;  //by default we won't render links, \n  renderer = Viva.Graph.View.renderer(graph, rendererSettings);\n  rendererSettings.container.onresize = () => {\n    if (renderer) {\n      renderer.reset(); fitAndCenter();\n    }\n  }\n\n  if(renderer)\n  {    \n    renderer.run();\n    fitAndCenter();\n\n    renderer.on(\"scroll\", (scale, offset) => canvas.onwheel({wheelDelta: scale, pageX: offset.x, pageY: offset.y}))\n  }\n\n  //saving these for debugging\n  if(process.env.NODE_ENV == 'development') {    \n    window.renderer = renderer;\n    window.rendererSettings = rendererSettings;\n    window.graph = graph\n  }\n}\n\n\nfunction resetAllNodes()\n{\n  clearHighlightedElements(highlightedElements)\n  highlightedElements.sticky = false\n\n  graph.forEachNode(n => highlightNode(n, false))\n\n  bus.fire('node-hovered', null)\n\n  // fitAndCenter(true, rendererSettings.forceDirLayout ? null : 1);\n  fitAndCenter()\n}\n\nfunction hoverHandler(node)\n{\n  clearHighlightedElements(highlightedElements)\n  highlightedElements = highlightNeighborhood(node)\n  renderer.rerender()\n\n  bus.fire('node-hovered', node)\n}\nfunction clickHandler(node)\n{\n  clearHighlightedElements(highlightedElements)\n\n  graph.forEachNode(hideNode)\n\n  highlightedElements = highlightNeighborhood(node)\n  highlightedElements.sticky = true\n  //1 instead of true will use special color for the node\n  highlightNode(node, 1) \n  renderer.rerender()\n\n  bus.fire('node-clicked', node)\n}\n\nfunction clearHighlightedElements(nhood)\n{\n  nhood.nodes.forEach(n => highlightNode(n, false));\n  nhood.links.forEach(n => highlightLink(n, false));\n  rendererSettings.renderLinks = false;\n\n  nhood.nodes = []\n  nhood.links = []\n}\n\nfunction highlightNeighborhood(node)\n{\n  var nhood = getNeighborhood(graph, node, rendererSettings.layoutType)\n\n  nhood.nodes.forEach(n => highlightNode(n, true))\n  nhood.links.forEach(l => highlightLink(l, true))\n  rendererSettings.renderLinks = nhood.links.size > 0\n\n  return nhood\n}\nfunction highlightOnlyStronglyDisimilarLinks()\n{\n  traverseLinks(graph).forEach(l => highlightLink(l, isStronglyDisimilar(l)))\n}\n\n\nfunction highlightLink(link, high) {\n  if(high){\n    // Equivalent to renderer.createLinkUi(link);\n    // but we don't have access to it\n    var linkPosition = layout.getLinkPosition(link.id);\n    graphics.addLink(link, linkPosition);\n  } else\n  {\n    // Equivalent to renderer.removeLinkUi(link);\n    // but we don't have access to it\n    graphics.releaseLink(link)\n  }\n}\n\nfunction hideNode(node)\n{\n  var nodeUI = graphics.getNodeUI(node.id);\n  nodeUI.alpha = 0.;\n  // nodeUI.size  = 0;\n}\n\nfunction highlightNode(node, high) {\n  var nodeUI = graphics.getNodeUI(node.id);\n  \n  //Change node color/size\n  if(nodeUI)\n  {\n    let ca = getNodeColorAlpha(node, high);\n    nodeUI.color = ca.color;\n    nodeUI.alpha = ca.alpha;\n\n    nodeUI.size  = getNodeSize(node, high);\n  }\n\n}\n\n\nfunction panBackground(e){\n    if(! mapbox.disableZoomPan )\n    {\n      //First, let's match the zoom. \n      //Note that Mapbox uses a different convention for zoom...\n      let zoom = e[0]\n      mapbox.jumpTo({zoom: Math.log2(zoom)+1, center: [0,0]})\n\n      //Next, let's match the pan - we use mapbox's unproject to make\n      //sure that the graph center matches.\n      let pan = {x: (e[12]+1)/2, y: -(e[13]+1)/2+1}\n      pan.x += (zoom - 1)/2\n      pan.y += (zoom - 1)/2\n      \n      let newCenter_xy = {x: -pan.x*mapbox._container.clientWidth  + 0.5*mapbox._container.clientWidth,\n                          y: -pan.y*mapbox._container.clientHeight + 0.5*mapbox._container.clientHeight}\n\n      let newCenter_latlon = mapbox.unproject(newCenter_xy)\n      mapbox.jumpTo({center: newCenter_latlon})\n\n\n      //In case we've panned to the edge of the screen, we should clip\n      //the renderer!\n      let actualCenter_xy = mapbox.project(newCenter_latlon)\n\n      //We're off by 10 pixels - tell renderer to move back!\n      if(Math.abs(actualCenter_xy.y - mapbox._container.clientHeight/2) > 5)\n      {\n        renderer.moveTo(newCenter_xy.x, newCenter_xy.y - (newCenter_latlon.lat < 0 ? 5: -5))         \n      }\n    }\n}\n\nfunction fitAndCenter(rerender = true, desiredZoom = 1){\n  let midPoint = {\n        x: mapbox._container.clientWidth/2,\n        y: mapbox._container.clientHeight/2,\n      };\n\n  if(desiredZoom == null){ \n    let graphRect = layout.getGraphRect();\n    if(rendererSettings.forceDirLayout){\n      graphRect = rendererSettings.forceDirLayout.getGraphRect()\n    }\n    let graphSize = Math.min(graphRect.x2 - graphRect.x1, graphRect.y2 - graphRect.y1);\n    let screenSize = Math.min(midPoint.x, midPoint.y)*2\n    desiredZoom = screenSize / graphSize * 0.8;\n  }\n\n  var cbAtEndOfZoom = () =>\n  {\n    renderer.moveTo(midPoint.x, midPoint.y) //move once zooming is done with..\n    if(rerender) {renderer.rerender(); setTimeout(function() {renderer.rerender()}, 200);}\n  }\n  zoomTo(desiredZoom, renderer.getTransform().scale, cbAtEndOfZoom)\n\n}\n\n// function zoomToOneShot(desiredScale, zPoint)\n// {\n//   if(zPoint == undefined)\n//   {\n//       zPoint = {\n//         x: mapbox._container.clientWidth/2,\n//         y: mapbox._container.clientHeight/2,\n//       };\n//   }\n//   //get current scale:\n//   let currentScale = renderer.getTransform().scale\n//   let scaleFactor = desiredScale / currentScale\n\n//   renderer.getGraphics().scale(scaleFactor, zPoint)\n//   renderer.getTransform().scale = scaleFactor\n// }\n// From https://github.com/anvaka/VivaGraphJS/issues/57\nfunction zoomTo(desiredScale, currentScale, cb = null) {\n    // zoom API in vivagraph 0.5.x is silly. There is no way to pass transform\n    // directly. Maybe it will be fixed in future, for now this is the best I could do:    \n    let newScale = currentScale;\n    if (desiredScale < currentScale) {\n        newScale = renderer.zoomOut();\n    }\n    else if(desiredScale > currentScale)\n    {\n        newScale = renderer.zoomIn();\n    }\n\n    //Recurse if we are not yet at the right scale!\n    if(Math.abs(desiredScale - newScale) > Math.abs(currentScale - newScale)/2)\n    {\n        setTimeout(() => zoomTo(desiredScale, newScale, cb), 20);\n    } else if(cb != null){\n      cb();\n    }\n}\n\nfunction getNodeSize(node, high)\n{\n  if (high === 1)\n    return 4;\n  else if (high)\n    return 3;\n  else\n    return 2;\n}\nfunction getNodeColorAlpha(node, high)\n{\n  const colors = {'EU': 0x0062ff, 'NA': 0x37ff00, 'SA': 0xfb00ff,\n                'AF': 0xffaa00, 'AS': 0xfffb00, 'OC':0xff0015,\n                'highlighted': 0xffffff, 'N/A': 0x7d7d7d}\n\n\n  var cAlpha = {color: colors[node.data.AuthorCont] || colors['N/A'], \n                alpha: high ? .9: .6}\n\n  if (high === 1){\n    cAlpha.color = 0xffffff\n  }\n  return cAlpha\n}\nfunction getLineColor(link)\n{\n// 0x1f77b4ff, 0xaec7e8ff,\n// 0xff7f0eff, 0xffbb78ff,\n// 0x2ca02cff, 0x98df8aff,\n// 0xd62728ff, 0xff9896ff,\n// 0x9467bdff, 0xc5b0d5ff,\n// 0x8c564bff, 0xc49c94ff,\n// 0xe377c2ff, 0xf7b6d2ff,\n// 0x7f7f7fff, 0xc7c7c7ff,\n// 0xbcbd22ff, 0xdbdb8dff,\n// 0x17becfff, 0x9edae5ff\n  if(link.data)\n  {\n    if(link.data.mostSimilar)\n      return 0x4238ffff;\n\n    if(link.data.leastSimilar)\n      return 0xff3838ff;\n  }\n\n  return 0xdedcf2ff;\n\n}\n\n\nfunction resetView() {\n  if(renderer)\n  {\n    renderer.reset();\n    fitAndCenter();\n  }\n}\n\n\n\nfunction dispose() {\n  // cancelAnimationFrame(rafHandle);\n  bus.off('load-graph', loadGraph);\n}\n\n\nfunction isStronglyDisimilar(link, minCount = 3)\n{\n  if(!link.data.leastSimilar) return false;\n\n  let nLeast = [new Set(), new Set()]\n\n  graph.getNode(link.fromId).links.forEach( l => {if (l.data.leastSimilar) nLeast[0].add(l.fromId).add(l.toId)} )\n  graph.getNode(link.toId  ).links.forEach( l => {if (l.data.leastSimilar) nLeast[1].add(l.fromId).add(l.toId)} )\n\n  //minCount + 1 since set will the self node in it\n  return (nLeast[0].size >= (minCount + 1) || nLeast[1].size >= (minCount + 1))\n}\n\nfunction springWeight(l, s, lType)\n{\n\n  if(lType == 'mostSimilar')\n  {\n    if (l.data.mostSimilar) {\n       s.length = 5;  s.weight = 3.0;\n     } else if (l.data.leastSimilar) { \n       s.length = l.data.d*1000; s.weight = 0.001;\n     } else { \n      s.length = l.data.d*50;   s.weight = 0.001;\n    }\n  }\n  else{ // .e.lType == 'leastSimilar'\n    if(l.data.leastSimilar){\n      //we will see if this link is connected to a node\n      //that has at least a total of 3 dissimilar nodes\n      //otherwise we won't use it in the clustering\n      s.length = 5;\n      s.weight = 3.0; //isStronglyDisimilar(l, 3) ? 3.0 : 0.001;\n    } else if (l.data.mostSimilar) { \n      s.length = l.data.d*1000; \n      s.weight = 0.001;\n    } else { \n      s.length = l.data.d*50;   s.weight = 0.001;\n    }\n  }\n}\n\nfunction toggleLayout(lType)\n{\n  rendererSettings.layoutType = lType\n  //dispose of any forceDirLayout if we already have one\n  if(rendererSettings.forceDirLayout)\n  {\n    rendererSettings.forceDirLayout.timer.stop()\n    rendererSettings.forceDirLayout.dispose()\n    rendererSettings.forceDirLayout = null\n  }\n\n  resetAllNodes()\n\n  //Reset position of nodes\n  graph.forEachNode( n => {n.position = {x: n.data.position.x, y: n.data.position.y} })\n\n  if (lType == 'mostSimilar' || lType == 'leastSimilar'){\n   \n    rendererSettings.forceDirLayout = Viva.Graph.Layout.forceDirected(graph, {\n          springLength : 50,\n          springCoeff : 0.001,\n          dragCoeff : .1,\n          gravity : -.01,\n          springTransform: ((l, s) => springWeight(l, s, lType))\n      })\n\n    rendererSettings.layout.placeNode(function(node) {\n      // read node position from force directed layout:\n      return graphics.getNodeUI(node.id).position = rendererSettings.forceDirLayout.getNodePosition(node.id);\n    });\n\n  } else if (lType === 'geo'){\n    rendererSettings.layout.placeNode(geoColocPositioner);\n    rendererSettings.layout.step();\n    graph.forEachNode( n => {geoColocPositioner(n); graphics.getNodeUI(n.id).position = n.position = n.data.position});\n\n    // graph.forEachNode( n => {n.position = n.data.position})\n  } else {\n    console.error('Unsupported layout type ' + lType)\n    return;\n  }\n\n  //Finally, if this is a non-geo layout, simulate it\n  if(lType != 'geo' && rendererSettings.forceDirLayout)\n  {\n    mapbox.disableZoomPan = true\n    rendererSettings.renderLinks = true\n\n    // let renderer know we want it to render links\n    //Finally run a timer to step the simulation and render.\n    rendererSettings.forceDirLayout.maxSteps = 200\n    rendererSettings.forceDirLayout.timer =\n            Viva.Graph.Utils.timer(() => {\n              try {\n                let stable = rendererSettings.forceDirLayout.step(); \n                if(rendererSettings.forceDirLayout.maxSteps % 40 == 0 || stable){\n                  fitAndCenter(false, null)\n                }\n                //highlight links halfway through\n                //TODO: do this progressively as springs reach equilibrium ?\n                if(rendererSettings.forceDirLayout.maxSteps == 25 || stable)\n                {\n                  if (lType == 'mostSimilar'){\n                    traverseLinks(graph).forEach( (l) => highlightLink(l, l.data[lType]))\n                  } else {\n                    highlightOnlyStronglyDisimilarLinks()\n                  }\n                  rendererSettings.renderLinks = true\n                }\n                renderer.rerender();\n                return (!stable && rendererSettings.forceDirLayout.maxSteps-- > 0);\n              } \n              catch { \n                renderer.rerender();\n                return false;\n              }\n            }, 30)\n  } else {\n    //re-enable mapbox panning/zooming\n    mapbox.disableZoomPan = false\n    //unhighlight links\n    traverseLinks(graph).forEach( (l) => highlightLink(l, false))\n    rendererSettings.renderLinks = false;\n    fitAndCenter()\n  }\n\n}\n\n} //end of Export\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return (_vm.showbox)?_c('div',{staticClass:\"info-box\"},[_c('fa-icon',{staticClass:\"close-box\",attrs:{\"icon\":[ 'fas', 'window-close' ]},on:{\"click\":function($event){$event.preventDefault();return _vm.closebox()}}}),_c('div',{staticClass:\"ac-header\"},[_vm._v(\"\\n      \"+_vm._s(_vm.nodeMetaData.label)+\"\\n      \"),_c('br'),_c('div',{staticClass:\"ac-setin\"},[_c('fa-icon',{attrs:{\"icon\":[ 'fas', 'map-marker' ]}}),_vm._v(\" \\n        \"+_vm._s(_vm.nodeMetaData.SetInCountry)+\"\\n      \")],1),_c('div',{staticClass:\"ac-author\"},[_c('fa-icon',{attrs:{\"icon\":[ 'fas', 'info-circle' ]}}),_vm._v(\"\\n        By \"+_vm._s(_vm.nodeMetaData.AuthorName)+\" (\"+_vm._s(_vm.nodeMetaData.AuthorCountry)+\")\\n      \")],1)]),_c('div',{staticClass:\"ac-storytext\"},[_c('fa-icon',{attrs:{\"icon\":[ 'fas', 'book' ]}}),_vm._v(\" \"+_vm._s(_vm.storyText)+\" \\n\\t\\t\")],1),(_vm.pars.showdetails)?_c('div',{staticClass:\"ac-related\"},[_vm._v(\"\\n      Related Stories: \\n      \"),_c('ul',{staticStyle:{\"margin-top\":\"3px\"}},[_vm._l((_vm.mostSimilarNodes),function(n){return _c('li',{key:n.id},[_c('div',{staticClass:\"ac-most\",on:{\"click\":function($event){$event.preventDefault();return _vm.goToNode(n)}}},[_vm._v(_vm._s(_vm.nodeTitle(n)))])])}),_vm._l((_vm.otherRelatedNodes),function(n){return _c('li',{key:n.id},[_c('div',{staticClass:\"ac-other\",on:{\"click\":function($event){$event.preventDefault();return _vm.goToNode(n)}}},[_vm._v(_vm._s(_vm.nodeTitle(n)))])])}),_vm._l((_vm.leastSimilarNodes),function(n){return _c('li',{key:n.id},[_c('div',{staticClass:\"ac-least\",on:{\"click\":function($event){$event.preventDefault();return _vm.goToNode(n)}}},[_vm._v(_vm._s(_vm.nodeTitle(n)))])])})],2)]):_c('div',{staticClass:\"ac-more\",on:{\"click\":function($event){$event.preventDefault();return _vm.readMore($event)}}},[_vm._v(\" Continue Reading ... \")])],1):_vm._e()}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\n<template>\n\t<div class='info-box' v-if='showbox' >\n    <fa-icon class='close-box' @click.prevent='closebox()' :icon=\"[ 'fas', 'window-close' ]\"/>\n\n\t\t<div class=\"ac-header\">\n      {{nodeMetaData.label}}\n      <br>\n\n      <div class=\"ac-setin\">\n        <fa-icon :icon=\"[ 'fas', 'map-marker' ]\"/> \n        {{nodeMetaData.SetInCountry}}\n      </div>\n\n      <div class=\"ac-author\">\n        <fa-icon :icon=\"[ 'fas', 'info-circle' ]\"/>\n        By {{nodeMetaData.AuthorName}} ({{nodeMetaData.AuthorCountry}})\n      </div>\n\n    </div>\n\n\t\t<div class=\"ac-storytext\"> \n\t\t\t<fa-icon :icon=\"[ 'fas', 'book' ]\"/> {{storyText}} \n\t\t</div>\n\n    <div class=\"ac-related\" v-if='pars.showdetails'>\n      Related Stories: \n      <ul style=\"margin-top: 3px\">\n        <!-- <li>\n          <div class=\"ac-most\" @click.prevent='goToNode(mostSimilarOutNode)'>{{nodeTitle(mostSimilarOutNode)}}</div>\n          <small>\n            <em v-if=\"mostSimilarInNode == mostSimilarOutNode\"> (Most Similar - bidirectional)</em>\n            <em v-else-if=\"mostSimilarInNode == null\">(Most Similar - outbound)</em>\n            <em v-else> (Most Similar - outbound)</em>\n          </small>\n        </li>\n\n        <li v-if=\"mostSimilarInNode != null && mostSimilarInNode != mostSimilarOutNode\">\n          <div class=\"ac-most\" @click.prevent='goToNode(mostSimilarInNode)'>{{nodeTitle(mostSimilarInNode)}}</div>\n          <small><em> (MostSimilar - inbound)</em></small>\n        </li> -->\n\n        <li v-for=\"n in mostSimilarNodes\" :key=\"n.id\">\n          <div class=\"ac-most\" @click.prevent='goToNode(n)'>{{nodeTitle(n)}}</div>\n          <!-- <small><em> (Related)</em></small> -->\n        </li>\n\n        <li v-for=\"n in otherRelatedNodes\" :key=\"n.id\">\n          <div class=\"ac-other\" @click.prevent='goToNode(n)'>{{nodeTitle(n)}}</div>\n          <!-- <small><em> (Related)</em></small> -->\n        </li>\n\n        <li v-for=\"n in leastSimilarNodes\" :key=\"n.id\">\n          <div class=\"ac-least\" @click.prevent='goToNode(n)'>{{nodeTitle(n)}}</div>\n          <!-- <small><em> (Related)</em></small> -->\n        </li>\n\n<!--         <li>\n          <div class=\"ac-least\" @click.prevent='goToNode(leastSimilarOutNode)'>{{nodeTitle(leastSimilarOutNode)}}</div>\n          <small><em> (Least Similar)</em></small>\n        </li> -->\n\n      </ul>\n    </div>\n    <div class=\"ac-more\" @click.prevent='readMore' v-else > Continue Reading ... </div>\n\n\t</div>\n</template>\n\n\n<script>\n/*eslint no-console: [\"error\", { allow: [ \"warn\", \"error\"] }] */\nimport bus from '../lib/bus';\nimport jsyaml from 'js-yaml';\nimport axios from 'axios';\nimport {getNeighborhood} from '../lib/createScene'\n\nexport default {\n\tname: 'StoryView',\n\tprops: ['pars'],\n\tdata() {\n\t\treturn {\n      showbox: false,\n      mostSimilarNodes  : [],\n      leastSimilarNodes : [],\n      otherRelatedNodes : [],\n      graph: null,\n      storyText: '',\n\t\t};\n\t},\n\n  watch: { \n    pars: {\n      deep: true,\n      immediate: true, \n      handler (pars, _oldpars) {  /* eslint-disable-line no-unused-vars */\n\n        //let's get story text if requested ... \n        this.storyText = 'No story selected ...'\n        if(pars.node)\n        {\n          this.showbox = true\n          this.storyText = pars.node.data.Excerpt;\n          if (pars.showdetails){\n            // TODO: actually fetch the story details and show them\n            this.storyText += ' (... Fetching more of the story ...)'\n            getStoryFullText(this.pars.node.id, this.$parent.year)\n              .then(txt => this.storyText = txt)\n          }\n        }\n\n        //we are going to extract the most/least similar nodes\n\n        //start by assuming they are null\n        this.mostSimilarNodes  = []\n        this.leastSimilarNodes = []\n        this.otherRelatedNodes = []\n\n        //if new node and graph are defined,\n        if (pars.node && this.$parent.graph) {\n          // let nhood = getNeighborhood(this.$parent.graph, pars.node, this.$parent.scene.rendererSettings.layoutType)\n          let nhood = getNeighborhood(this.$parent.graph, pars.node, 'geo')\n          // if(this.$parent.scene.rendererSettings.layoutType == 'geo')\n          {\n            nhood.nodes.forEach(n => {\n              if(pars.node.id != n.id){\n                let l = this.$parent.graph.getLink(pars.node.id, n.id)\n                if(!l) l = this.$parent.graph.getLink(n.id, pars.node.id)\n                if((l && l.data.mostSimilar)){\n                  this.mostSimilarNodes.push(n)\n                } else if ((l && l.data.leastSimilar)) {\n                  this.leastSimilarNodes.push(n)\n                } else {\n                  this.otherRelatedNodes.push(n)\n                }\n              }\n            })\n          }//end layout if case \n        }//endif\n      }//end handler\n    }//end pars\n  },//end watch\n\n\n\tmethods:\n  {\n    readMore(){\n      //pretend node was clicked which will get App.vue to trigger on that node\n      //therefore this component will re-render but with showdetails = true...\n      //hacky, but that's because we're not allowed to change showdetails as its a prop :s\n      bus.fire('emulate-node-click', this.pars.node);\n    },\n\n    goToNode(node){\n      if(node) {\n        bus.fire('emulate-node-click', node);\n      }\n    },\n\n    nodeTitle(node) {\n      return node ? node.data.label : 'None?'\n    },\n\n    closebox(){\n      this.showbox = false;\n      bus.fire('resetview')\n    }\n  },\n\n\tcomputed:\n\t{\n\t\tnodeMetaData(){\n\t\t\tif(this.pars.node)\n\t\t\t{\n\t\t\t\treturn this.pars.node.data\n\t\t\t}\n\t\t\treturn {label: 'No story selected ...'}\n\t\t},\n\t}\n}\n\n\n\nfunction getStoryFullText(node_id, year)\n{\n  let storageURL = `https://storage.googleapis.com/nomadstories/dataFolder/${year}/`\n  storageURL += encodeURIComponent(node_id)\n\n  return axios.get(storageURL).then( \n      response => { return jsyaml.load(response.data)['Text'];})\n    .catch( e => {return e});\n}\n\n\n\n</script>\n\n\n<style scoped>\n* {\n    box-sizing: border-box;\n    z-index: 1; /* this might backfire? */\n}\n\n.info-box {\n  position: absolute;\n  left: 8px;\n  padding: 14px;\n  top: 2vh;\n  width: 420px;\n  background: rgba(255, 255, 255, 0.8);\n  box-shadow: 0 2px 4px rgba(0,0,0,.2), 0 -1px 0 rgba(0,0,0,.02);\n\n  max-height: 88vh;\n  max-width: 95vw;\n  overflow-y: scroll;\n  border-radius: 2%;\n  z-index: 1;\n\n}\n\n\n.ac-header {\n  font-size: 1.25em;\n  text-align: center;\n  margin: 0px\n}\n\n.ac-setin,\n.ac-author {\n  font-size: 0.6em !important; \n  margin: 8px;\n}\n\n\n.ac-more {\n  cursor: pointer;\n  color: blue;\n}\n\n.ac-related {\n  display: inline\n}\n\n.ac-other,\n.ac-most,\n.ac-least\n{\n  cursor: pointer;\n  color: blue;\n  display: inline;\n}\n.ac-other\n{\n  color: gray;\n}\n.ac-least\n{\n  color: red;\n}\n\n.ac-storytext{\n  margin: 20px 0px;\n  white-space: pre-line;\n\n  max-height: 30vw;\n  overflow-y: scroll;\n\n  background: rgba(150, 150, 150, 0.4);\n}\n\n@media all and (min-width:0px) and (max-width: 640px) {\n  .ac-storytext {\n    max-height: 85vw;\n  }\n}\n\n\n.close-box {\n  position: sticky;\n  top: 0;\n  float: right;\n  margin: 0px;\n  font-size: 20px;\n  font-weight: bold;\n  cursor: pointer;\n  color: rgb(100,100,100);\n  z-index: 2;\n}\n\n</style>","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./StoryView.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./StoryView.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./StoryView.vue?vue&type=template&id=82c1344c&scoped=true&\"\nimport script from \"./StoryView.vue?vue&type=script&lang=js&\"\nexport * from \"./StoryView.vue?vue&type=script&lang=js&\"\nimport style0 from \"./StoryView.vue?vue&type=style&index=0&id=82c1344c&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"82c1344c\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"container row\"},[_c('div',{staticClass:\"search col-xs-12 col-sm-6 col-md-4\"},[_c('form',{staticClass:\"search-form\",attrs:{\"role\":\"search\"},on:{\"submit\":function($event){$event.preventDefault();return _vm.onSubmit($event)}}},[_c('div',{staticClass:\"input-group\"},[_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.searchPattern),expression:\"searchPattern\"}],staticClass:\"form-control no-shadow\",attrs:{\"type\":\"text\",\"placeholder\":\"Search Stories\"},domProps:{\"value\":(_vm.searchPattern)},on:{\"focus\":function($event){_vm.searchInputFocused = true},\"blur\":_vm.unfocusTimeout,\"input\":function($event){if($event.target.composing){ return; }_vm.searchPattern=$event.target.value}}}),_c('fa-icon',{staticClass:\"btn\",attrs:{\"tabindex\":\"-1\",\"type\":\"button\",\"icon\":[ 'fas', 'search' ]}})],1)]),(_vm.showSearchResults)?_c('div',{staticClass:\"search-results\"},[_c('div',{staticClass:\"scroll-wrapper\"},[_c('ul',_vm._l((_vm.matchedNodes),function(n){return _c('li',{key:n.id},[_c('a',{attrs:{\"href\":\"#\"},on:{\"click\":function($event){return _vm.showDetails(n, true)},\"mouseover\":function($event){return _vm.showDetails(n, false)}}},[_vm._v(\" \"+_vm._s(n.data.label)+\" \")])])}),0)])]):_vm._e()])])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n<div class=\"container row\">\n  <div class=\"search col-xs-12 col-sm-6 col-md-4\">\n    \n\n    <form class=\"search-form\" role=\"search\" v-on:submit.prevent=\"onSubmit\"> \n      <div class=\"input-group\">\n        <input v-model=\"searchPattern\" \n              @focus=\"searchInputFocused = true\"\n              @blur=\"unfocusTimeout\"\n        type=\"text\" class=\"form-control no-shadow\" placeholder=\"Search Stories\" />\n\n        <fa-icon class=\"btn\" tabindex=\"-1\" type=\"button\" :icon=\"[ 'fas', 'search' ]\"/>\n\n      </div>\n    </form>\n\n\n    <div class=\"search-results\" v-if=\"showSearchResults\">\n      <div class=\"scroll-wrapper\">\n        <ul>\n          <li v-for=\"n in matchedNodes\" :key=\"n.id\">\n            <a href=\"#\" @click='showDetails(n, true)' @mouseover='showDetails(n, false)'> {{n.data.label}} </a>\n          </li>\n        </ul>\n      </div>\n    </div>\n\n\n  </div>\n\n\n</div>\n\n\n</template>\n\n\n\n<script>\n/*eslint no-console: [\"error\", { allow: [ \"warn\", \"error\"] }] */\nimport bus from '../lib/bus';\n\nexport default {\n  name: 'SearchView',\n  data() {\n      return {\n          searchPattern: '',\n          searchInputFocused: false,\n          lastInputHandle: 0,\n          matchedNodes: [],\n      };\n  },\n\n  computed:{\n    showSearchResults(){\n      return this.$parent.graph && (this.searchInputFocused) && \n             this.searchPattern && (this.searchPattern.length > 3);\n    }\n  },\n  watch:\n  {\n    searchPattern: function (newPattern, oldVal){  /* eslint-disable-line no-unused-vars */\n\n      if (! this.showSearchResults)\n        return; // probably we are still loading...\n\n      // we are throttling input here. No need to react to every keystroke:\n      if (this.lastInputHandle) {\n        clearTimeout(this.lastInputHandle);\n        this.lastInputHandle = 0;\n      }\n\n      var self = this\n      this.lastInputHandle = setTimeout(function() {\n        self.matchedNodes = getAllMatches(self.$parent.graph, newPattern);\n        // showMatches(allMatches, header);\n        self.lastInputHandle = 0;\n      }, 150);\n\n    }\n  },\n\n  methods:\n  {\n    unfocusTimeout()\n    {\n      var self = this;\n      setTimeout(function() {self.searchInputFocused = false}, 150);\n    },\n\n    onSubmit()\n    {\n        return null\n    },\n\n    showDetails(node, click)\n    {\n        bus.fire(click ? 'emulate-node-click' : 'emulate-node-hover', node);\n    }\n  },\n}\n\nfunction getAllMatches(graph, pattern) {\n  var allMatches = [];\n  var matcher = compileMatcher(pattern);\n  graph.forEachNode(function(node) {\n    if (matcher.isMatch(node.data) && allMatches.length < 50) \n      allMatches.push(node);\n  });\n\n  return allMatches;\n}\n\nfunction compileMatcher(pattern) {\n  var rMatch = compileRegex(pattern);\n  return {\n    isMatch: function(data) {\n      // a simple name based match. Could be extended to complex filters\n      return rMatch && data && \n              ( (data.label   && data.label.match(rMatch)) ||\n                (data.Excerpt && data.Excerpt.match(rMatch)) ||\n                (data.SetInCountry && data.SetInCountry.match(rMatch)) ||\n                (data.AuthorCountry && data.AuthorCountry.match(rMatch)) ||\n                (data.AuthorName && data.AuthorName.match(rMatch))\n              ) ;\n    }\n  }\n}\n\nfunction compileRegex(pattern) {\n  try {\n    return new RegExp(pattern, 'ig');\n  } catch (e) {\n    // this cannot be compiled. Ignore it.\n  }\n}\n\n\n\n\n</script>\n\n<style scoped>\n* {\n    box-sizing: border-box;\n    z-index: 1; /* this might backfire? */\n}\n\n.search {\n  position: absolute;\n  top: 1vh;\n  right: 5px;\n  z-index: 1;\n}\n\n.search-form input {\n  width: 20vw;\n  background: rgba(26, 26, 26, 0.5);\n  color: white;\n  border-radius: 0;\n  border: 0;\n  line-height: 25px;\n  font-size: 14pt;\n  padding-left: 5px;\n}\n\n.search-form .input-group .btn {\n  color: gray;\n  margin-left: -20px;\n  display: inline;\n}\n\n.search .search-results {\n  padding-top: 5px;\n  /*background: rgba(255, 255, 255, 0.8);*/\n  max-width: 20vw;\n  max-height: 30vh;\n}\n\n.search .scroll-wrapper {\n  border-top: 1px solid #808080;\n  height: 250px;\n  /*background: rgba(255, 255, 255, 0.8);*/\n  box-shadow: 0 2px 4px rgba(0,0,0,.2), 0 -1px 0 rgba(0,0,0,.02);\n  max-height: 96vh;\n  max-width: 25vw;\n  overflow-y: scroll;\n  text-overflow: ellipsis;\n}\n\n.scroll-wrapper ul {\n  overflow-y: scroll;\n  text-overflow: ellipsis;\n  width: 100%;\n  height: 100%;\n  list-style: none;\n  margin: 0;\n  box-sizing: content-box;\n  padding-top: 0px;\n  padding-right: 10px;\n  padding-bottom: 0;\n  padding-left: 0;\n}\n\n.scroll-wrapper ul li {\n  height: 25px;\n  max-width: 100%;\n  text-overflow: ellipsis;\n}\n.scroll-wrapper ul li a {\n  opacity: 0.9;\n  text-decoration: none;\n  width: 100%;\n  height: 100%;\n  /*display: block;*/\n  margin: 0;\n  padding: 0;\n  padding-left: 5px;\n  line-height: 25px;\n  white-space: nowrap;\n  &:hover,\n  &:focus{\n    text-decoration:none;\n    opacity: 1;\n    background:rgba(26, 26, 26, 0.95);\n  }\n}\n\n\n\n</style>","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./SearchView.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./SearchView.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./SearchView.vue?vue&type=template&id=19afbe98&scoped=true&\"\nimport script from \"./SearchView.vue?vue&type=script&lang=js&\"\nexport * from \"./SearchView.vue?vue&type=script&lang=js&\"\nimport style0 from \"./SearchView.vue?vue&type=style&index=0&id=19afbe98&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"19afbe98\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return (_vm.showFilter)?_c('div',{staticClass:\"filter-box\"},[_c('div',{staticClass:\"f-year\"},[_vm._v(\"\\n    Story Years: \\n    \"),_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.selectedYear),expression:\"selectedYear\"}],attrs:{\"type\":\"radio\",\"value\":\"2018\"},domProps:{\"checked\":_vm._q(_vm.selectedYear,\"2018\")},on:{\"change\":function($event){_vm.selectedYear=\"2018\"}}}),_c('label',[_vm._v(\"2018\")]),_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.selectedYear),expression:\"selectedYear\"}],attrs:{\"type\":\"radio\",\"value\":\"2019\"},domProps:{\"checked\":_vm._q(_vm.selectedYear,\"2019\")},on:{\"change\":function($event){_vm.selectedYear=\"2019\"}}}),_c('label',[_vm._v(\"2019\")]),_c('fa-icon',{staticClass:\"close-filter\",attrs:{\"icon\":[ 'fas', 'window-close' ]},on:{\"click\":function($event){$event.preventDefault();return _vm.closeShow()}}})],1),_c('div',{staticClass:\"f-geo\"},[_vm._v(\"\\n    Layout Clustering: \\n    \"),_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.selectedLayout),expression:\"selectedLayout\"}],attrs:{\"type\":\"radio\",\"value\":\"geo\"},domProps:{\"checked\":_vm._q(_vm.selectedLayout,\"geo\")},on:{\"change\":function($event){_vm.selectedLayout=\"geo\"}}}),_c('label',[_vm._v(\"Geo\")]),_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.selectedLayout),expression:\"selectedLayout\"}],attrs:{\"type\":\"radio\",\"value\":\"mostSimilar\"},domProps:{\"checked\":_vm._q(_vm.selectedLayout,\"mostSimilar\")},on:{\"change\":function($event){_vm.selectedLayout=\"mostSimilar\"}}}),_c('label',[_vm._v(\"Similar\")]),_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.selectedLayout),expression:\"selectedLayout\"}],attrs:{\"type\":\"radio\",\"value\":\"leastSimilar\"},domProps:{\"checked\":_vm._q(_vm.selectedLayout,\"leastSimilar\")},on:{\"change\":function($event){_vm.selectedLayout=\"leastSimilar\"}}}),_c('label',[_vm._v(\"Disimilar\")])])]):_vm._e()}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\n<template>\n  <div class='filter-box' v-if='showFilter'>\n    <div class=\"f-year\">\n      Story Years: \n      <input type=\"radio\" value=\"2018\" v-model=\"selectedYear\">\n                          <label>2018</label>\n      <input type=\"radio\" value=\"2019\" v-model=\"selectedYear\">\n                          <label>2019</label>\n    <fa-icon class='close-filter' @click.prevent='closeShow()' :icon=\"[ 'fas', 'window-close' ]\"/>\n    </div>\n\n    <div class=\"f-geo\">\n      Layout Clustering: \n      <input type=\"radio\" value=\"geo\" v-model=\"selectedLayout\">\n                          <label>Geo</label>\n      <input type=\"radio\" value=\"mostSimilar\" v-model=\"selectedLayout\">\n                          <label>Similar</label>\n      <input type=\"radio\" value=\"leastSimilar\" v-model=\"selectedLayout\">\n                          <label>Disimilar</label>\n    </div>\n  </div>\n</template>\n\n\n<script>\n/*eslint no-console: [\"error\", { allow: [ \"warn\", \"error\"] }] */\nimport bus from '../lib/bus'\nimport {getGraph} from '../lib/getGraph';\n\nexport default {\n  name: 'FilterView',\n  // props: ['show'],\n  data() {\n    return {\n      selectedYear: '2019',\n      selectedLayout: 'geo',\n      leastSimilarNode: null,\n      otherRelatedNodes: [],\n      graph: null,\n      storyText: '',\n    };\n  },\n\n  created() {\n    //FIXME: this probably fires toggleLayout unnecessarily\n    bus.on('load-graph', () => {this.selectedLayout = 'geo'})\n  },\n\n  computed:{\n    showFilter() {\n      return this.$parent.showFilter\n    }\n  },\n  methods:{\n    closeShow(){\n      this.$parent.showFilter = false;\n    }\n  },\n  watch: {\n    selectedYear:\n    {\n      handler (new_year, old_year) { \n        if(new_year != old_year){\n          getGraph(this.$parent.mapbox, new_year);\n        }\n      }//end handler\n    },\n    selectedLayout:\n    {\n      handler (new_layout, old_layout){\n        if(new_layout != old_layout){\n          this.$parent.scene.toggleLayout(new_layout)\n        }\n      }\n    },\n    show: {\n      // handler (new_val, _oldpars) {   eslint-disable-line no-unused-vars \n      //   this.showFilter = new_val\n      // }//end handler\n    }//end pars\n  },//end watch\n}\n\n\n\n\n</script>\n\n<style scoped>\n* {\n    box-sizing: border-box;\n    z-index: 1; /* this might backfire? */\n}\n\n.filter-box {\n  position: absolute;\n  right: 8px;\n  padding: 2px 4px;\n  bottom: 9px;\n  background: rgba(150, 150, 150, 0.9);\n  box-shadow: 0 2px 4px rgba(0,0,0,.2), 0 -1px 0 rgba(0,0,0,.02);\n\n  max-height: 88vh;\n  overflow-y: scroll;\n  border-radius: 1%;\n  z-index: 2;\n}\n\n@media all and (min-width:0px) and (max-width: 640px) {\n  .filter-box{\n    font: 9px/20px 'Helvetica Neue', Arial, Helvetica, sans-serif;\n/*    max-width: unset;\n    max-height: 1vh;\n    right: unset;*/\n    line-height: 5px;\n  }\n}\n\n\n.f-geo, .f-year {\n  margin-top: 2px;\n  margin-bottom: 2px;\n}\n\n.f-year input, \n.f-geo input {\n  margin: 5px;\n  margin-top: -1px;\n  vertical-align: middle;\n}\n\n.close-filter {\n  float: right;\n  margin: 0px;\n  padding: 0px;\n  font-size: 12px;\n  font-weight: bold;\n  color: rgba(200, 200, 200);\n  cursor: pointer;\n}\n\n</style>","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./FilterView.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./FilterView.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./FilterView.vue?vue&type=template&id=1bef21e4&scoped=true&\"\nimport script from \"./FilterView.vue?vue&type=script&lang=js&\"\nexport * from \"./FilterView.vue?vue&type=script&lang=js&\"\nimport style0 from \"./FilterView.vue?vue&type=style&index=0&id=1bef21e4&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"1bef21e4\",\n  null\n  \n)\n\nexport default component.exports","<template>\n  <div id=\"app\">\n          <!-- Set the display of this container to none so we can\n         add it programmatically to `legendControl` -->\n\n    <div class='legend' v-show='!showAbout'>\n      <div class=\"country\">\n        <h4>Author Country:</h4>\n        <div><span style='background-color: #ffaa00'></span>Africa</div>\n        <div><span style='background-color: #fffb00'></span>Asia</div>\n        <div><span style='background-color: #0062ff'></span>Europe</div>\n        <div><span style='background-color: #37ff00'></span>N. America</div>\n        <div><span style='background-color: #fb00ff'></span>S. America</div>\n        <div><span style='background-color: #ff0015'></span>Oceania</div>\n      </div>\n\n      <div class=\"links\">\n        <h4>Story Similarity:</h4>\n        <div><span style=\"color:#4949ff; \">&#8211;</span>Most</div>\n        <div><span style=\"color:gray;\">&#8211;</span>Somewhat</div>\n        <div><span style=\"color:red; \">&#8211;</span>Least</div>\n      </div> \n    </div>\n\n    <div id=\"mapCanvas\"></div>\n    <div id=\"cnv\"></div>\n\n\n\n\n\n    <story-view id='story' :pars='storyViewPars'  v-if='showStory'> </story-view>\n\n    <search-view id='search' v-if='!isMobile()'></search-view>\n\n    <div id='about' class='about-box' v-if='showAbout'>\n        <fa-icon class='close-about' @click.prevent='closeAbout()' :icon=\"[ 'fas', 'window-close' ]\"/>\n        <h2>About <em>Nomads' Vue</em></h2>\n        <div style='text-align: left'>\n        <p>\n          <span style='font-weight: bold;'>Intro</span>\n          This project is intended to help explore travel stories by thousands of people that have been submitted to the Travel Nomad Contest.<br>\n\n          Hopefully this makes the submissions of these aspiring writers fun to explore, and that a wide audience of users finds it interesting; whether it be aspiring travel writers, daydreaming office workers thinking about exploring a new destination, or social scientists interested in understanding why and how people travel. In a time where it feels like differences between nations and their people are amplified, I hope this serves as reminder that so many of us are connected through the way we experience our planet and each other.\n\n          <br><br>\n          <span style='font-weight: bold;'>How to Use</span>\n\n          When a story is hovered or selected, the story and its metadata (location, author, title) are displayed in a reading pane on the left. A Neural-Network model was trained on the stories to find relations between them, and similar as well as the least similar stories to the selected story that are identified by the model are highlighted and can be explored from the graph or the reading view.<br>\n\n          The stories are displayed geographically and color-coded by the continent origin of the author. It is also possible to cluster most similar or least similar stories together using the options popup in the bottom-right corner.\n\n          The stories' metadata are searchable using the top-right corner box.\n          <br><br>\n\n          Go Ahead - Explore the map, hover on stories, search for keywords, and enjoy reading the stories!<br>\n          If you get lost or the screen bugs up, <b>double click to reset</b>\n          <br><br> \n\n          <span style='font-weight: bold;'>Credits</span>\n          This project is made possible thanks to the following packages and data:\n          <ul>\n              <li><a target=\"_blank\" href=\"https://www.worldnomads.com/create/scholarships/writing/2018/results\">Travel Nomad Stories</a></li>\n              <li><a target=\"_blank\" href=\"https://radimrehurek.com/gensim/models/doc2vec.html\">GenSim (Doc2Vec)</a></li>\n              <li><a target=\"_blank\" href=\"https://github.com/vuejs/awesome-vue\">Vue.js</a></li>\n              <li><a target=\"_blank\" href=\"https://github.com/anvaka/VivaGraphJS\">VivaGraphJS (w/ WebGL renderer)</a><li><a target=\"_blank\" href=\"https://www.mapbox.com/\">Mapbox</a></li>\n          </ul>\n\n          For more background, insights, and technical details; check out my <a target=\"_blank\" href=\"https://zouhairm.github.io/nomadStories\">Blog Post</a>\n\n        </p>\n        </div>\n        <!-- <a href='#' @click.prevent='showAbout = false'  class='close-about' title='Close this message'>Close</a> -->\n    </div>\n\n    <filter-view id='filter'> </filter-view>\n\n    <div class='footer'>\n        <a @click.prevent='toggleAbout()' class='about-link'>About</a>\n        <p class='copyText'>\n            Made during late night hours by <a target=\"_blank\" href=\"https://zouhairm.github.io/bio\">Zouhair M</a>\n        </p>\n\n        <a v-if='!showAbout' @click.prevent='showFilter = !showFilter && !showAbout' class='options-link'>Settings</a>\n    </div>\n\n\n\n  </div>\n</template>\n\n<script>\n/*eslint no-console: [\"error\", { allow: [ \"warn\", \"error\"] }] */\n\nimport {createScene} from './lib/createScene';\nimport bus from './lib/bus';\n\n\nimport StoryView  from './components/StoryView.vue'\nimport SearchView from './components/SearchView.vue'\nimport FilterView from './components/FilterView.vue'\n\nvar mapboxgl = require('mapbox-gl');\n\n\nexport default {\n  name: 'app',\n  data() {\n    \n    return {\n      scene: null,\n      showAbout: true,\n      showFilter: false,\n      graph: null,\n      mapbox: null,\n      storyViewPars: { node: null, showdetails: false},\n      year: '2019',\n    };\n  },\n\n\n  methods: {\n    toggleAbout() {\n      this.showAbout = !this.showAbout;\n      this.showFilter = !this.showAbout && !this.isMobile()\n    },\n    closeAbout() {\n      this.showAbout = false\n      this.showFilter = !this.isMobile()\n    },\n    isMobile() {\n     return /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)\n    }\n  },\n\n  computed:\n  {\n    showStory() {\n      //don't show if showabout is being show\n      if(this.showAbout) return false\n\n      //otherwise show if selected node is not null\n      return this.storyViewPars.node !=null\n    }\n\n  },\n\n  components:\n  {\n    SearchView,\n    StoryView,\n    FilterView,\n  },\n\n  created(){\n    bus.on('load-graph', (g, year) => {this.graph = g; this.year = year});\n  },\n  mounted() {\n\n    this.$ga.page(window.location.pathname)\n\n    //Token restricted to zouhairm.github.io/nomadsVue - please don't steal :p\n    mapboxgl.accessToken = 'pk.eyJ1Ijoiem9vaGFpciIsImEiOiJjanlmMWRzenExN2N4M2xzOGVvdDg2eG9jIn0.HX4LVDqBgxUKivoqPLk_4w'\n    \n    this.mapbox = new mapboxgl.Map({\n      container: 'mapCanvas',\n      style: 'mapbox://styles/mapbox/dark-v9',\n      center: [0, 0],\n      zoom: 1,\n      minZoom: 1,\n      maxZoom: 10,\n    });\n    this.mapbox.scrollZoom.disable()\n    this.mapbox.dragPan.disable()\n\n\n\n    const canvas = document.getElementById('cnv');\n    this.scene = createScene(canvas, this.mapbox);\n\n    //needed to provide closure in the\n    //callbacks below -- yay JS !\n    var self = this\n\n    //register and handle events\n    bus.on('node-hovered', nodeHovered);\n    bus.on('node-clicked', nodeClicked);\n    function nodeHovered(node)\n    {\n      self.storyViewPars.node = node;\n      self.storyViewPars.showdetails = false;\n    }\n\n    function nodeClicked(node)\n    {\n      self.storyViewPars.node = node;\n      self.storyViewPars.showdetails = true;\n\n      //if clicked, forceShowAbout to close!\n      self.showAbout = false\n\n    }\n\n\n  },\n  beforeDestroy() {\n    if (this.scene) {\n      this.scene.dispose();\n    }\n  }\n\n}\n</script>\n\n<style>\n* {\n    box-sizing: border-box;\n    z-index: 1; /* this might backfire? */\n}\n\nbody {\n  margin: 0;\n  width: 100%;\n  height: 100%;\n  overflow: hidden;\n  position: absolute;\n\n  /* font info has to be applied to body so it applies to mouse overs and date picker */\n  font-family: Helvetica, Arial, sans-serif;\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#app {\n  position: relative;\n  width: 100%;\n  height: 100%;\n}\n\n#mapCanvas {\n  z-index:0;\n  position: absolute;\n  width: 100vw;\n  height: 100vh;\n  left: 0;\n  right: 0;\n  top: 0;\n  bottom: 0;\n}\n#cnv {\n  z-index: 0;\n  width: 100vw;\n  height: 100vh;\n  left: 0;\n  right: 0;\n  top: 0;\n  bottom: 0;\n  background-color: #000000d9;\n  touch-action: none;\n}\ncanvas{ position: relative; z-index: 1 }\n\n\n.btn-command {\n  display: block;\n  width: 20%;\n  padding: 4px;\n  margin-top: 10px;\n  border: 1px solid;\n  color: red;\n  position: relative;\n}\n\na {\n  color: rgb(53, 162, 162);\n  text-decoration: none;\n  text-align: center;\n  padding: 0 4px\n}\n\n\n.footer {\n  position: absolute;\n  width: 100%;\n  left: 10px;\n  bottom : 9px;\n  display: flex;\n  z-index: 1;\n\n}\n\n.copyText {\n  font-size: 9px;\n  color: #999;\n}\n\n.about-box {\n  position: absolute;\n  overflow: scroll;\n  max-height: 80vh;\n  max-width: 75vw;\n\n  margin: auto;\n  left: 0; right: 0; top: 64px;\n\n  padding: 10px;\n  background: rgba(255, 255, 255, 0.9);\n  box-shadow: 0 2px 4px rgba(0,0,0,.2), 0 -1px 0 rgba(0,0,0,.02);\n  z-index: 1;\n}\n@media all and (min-width:0px) and (max-width: 640px) {\n.about-box {\n  position: absolute;\n  left: 8px;\n  padding: 14px;\n  top: 2vh;\n  width: 420px;\n  background: rgba(255, 255, 255, 0.8);\n  box-shadow: 0 2px 4px rgba(0,0,0,.2), 0 -1px 0 rgba(0,0,0,.02);\n  max-height: 88vh;\n  max-width: 95vw;\n  overflow-y: scroll;\n  border-radius: 2%;\n  z-index: 1;\n  }\n}\n\n.about-link {\n  background: rgba(0, 120, 120, 0.4);\n  padding: 5px 10px;\n  margin-right: 5px;\n  border-radius: 5%;\n  cursor: pointer;\n  z-index: 1;\n}\n.options-link {\n  background: rgba(0, 120, 120, 0.4);\n  padding: 5px 10px;\n  margin-right: 5px;\n  position: absolute;\n  right: 20px;\n  border-radius: 5%;\n  cursor: pointer;\n  z-index: 1;\n}\n\n.close-about {\n  position: sticky;\n  top: 0;\n  float: right;\n  margin: 0px;\n  font-size: 20px;\n  font-weight: bold;\n  cursor: pointer;\n  color: rgb(100,100,100);\n  z-index: 2;\n}\n\n.legend {\n  z-index: 1;\n  /*background-color: rgb(100,100,100, 0.05);*/\n  color: gray;\n  /*box-shadow: 0 1px 2px rgba(0,0,0,0.10);*/\n  font: 12px/20px 'Helvetica Neue', Arial, Helvetica, sans-serif;\n  position: absolute;\n  display: inline-grid;\n\n  margin: auto;\n  right: 0px;\n  left: 0px;\n  top: 5px;\n  max-width: 35vw;\n  height: 6vh;\n}\n\n@media all and (min-width:0px) and (max-width: 640px) {\n  .close-about {\n    font-size:25px;\n  }\n  .legend{\n    font: 9px/20px 'Helvetica Neue', Arial, Helvetica, sans-serif;\n    max-width: unset;\n    max-height: 1vh;\n    right: unset;\n    line-height: 5px;\n  }\n}\n\n.legend .country,\n.legend .links{\n  display: inline-flex;\n}\n \n.legend h4 {\n  margin: 0 5px 5px;\n}\n \n.legend div span {\n  border-radius: 50%;\n  display: inline-block;\n  height: 5px;\n  width: 5px;\n  margin-right: 5px;\n  margin-left: 5px;\n}\n\n.legend .links div span {\n  -webkit-text-stroke-width:4px;\n}\n\n\n</style>\n","import mod from \"-!../node_modules/cache-loader/dist/cjs.js??ref--12-0!../node_modules/thread-loader/dist/cjs.js!../node_modules/babel-loader/lib/index.js!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../node_modules/cache-loader/dist/cjs.js??ref--12-0!../node_modules/thread-loader/dist/cjs.js!../node_modules/babel-loader/lib/index.js!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./App.vue?vue&type=template&id=17a316f0&\"\nimport script from \"./App.vue?vue&type=script&lang=js&\"\nexport * from \"./App.vue?vue&type=script&lang=js&\"\nimport style0 from \"./App.vue?vue&type=style&index=0&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","import Vue from 'vue'\nimport App from './App.vue'\n\n\nimport VueAnalytics from 'vue-analytics'\nVue.use(VueAnalytics, {\n  id: 'UA-144701829-1',\n  autoTracking: {screenview: true},\n  debug: { sendHitTask: process.env.NODE_ENV === 'production'}\n})\n\n//1st, configure font-awesome\nimport { library } from '@fortawesome/fontawesome-svg-core' //get library and add icons of interest\nimport { fas } from '@fortawesome/free-solid-svg-icons'; //we want the free icons\nlibrary.add(fas); //add the free icons\n\n//2nd, get the vue <-> font awesome component and register it with the app\nimport { FontAwesomeIcon } from '@fortawesome/vue-fontawesome'\nVue.component('fa-icon', FontAwesomeIcon)\nVue.config.productionTip = false\n\n\nnew Vue({\n  render: h => h(App),\n}).$mount('#app')\n","import mod from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/css-loader/index.js??ref--6-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./SearchView.vue?vue&type=style&index=0&id=19afbe98&scoped=true&lang=css&\"; export default mod; export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/css-loader/index.js??ref--6-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./SearchView.vue?vue&type=style&index=0&id=19afbe98&scoped=true&lang=css&\""],"sourceRoot":""}